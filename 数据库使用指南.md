# ğŸ“š æ•°æ®åº“ä½¿ç”¨æŒ‡å—

## é—®é¢˜ï¼šæ¯æ¬¡éƒ½è¦é‡æ–°æ„å»ºç´¢å¼•å—ï¼Ÿ

**ä¸éœ€è¦ï¼** æœ¬ç³»ç»Ÿå·²ç»å®ç°äº†æŒä¹…åŒ–å­˜å‚¨ï¼Œç´¢å¼•ä¼šè‡ªåŠ¨ä¿å­˜åˆ°ç£ç›˜ã€‚

## ğŸ¯ ä¸‰ç§ä½¿ç”¨æ–¹å¼

### æ–¹å¼1: æœ¬åœ°æŒä¹…åŒ–å­˜å‚¨ï¼ˆé»˜è®¤ï¼Œæ¨èï¼‰

**ç‰¹ç‚¹ï¼š**
- âœ… è‡ªåŠ¨ä¿å­˜ç´¢å¼•åˆ° `./storage` ç›®å½•
- âœ… é‡å¯åè‡ªåŠ¨åŠ è½½ï¼Œæ— éœ€é‡å»º
- âœ… åªåœ¨ä¸Šä¼ æ–°æ–‡æ¡£æ—¶æ‰é‡å»º
- âœ… å®Œå…¨å…è´¹ï¼Œæ— éœ€å¤–éƒ¨æœåŠ¡

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# é¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨æ„å»ºç´¢å¼•
python app.py

# å†æ¬¡å¯åŠ¨ä¼šç›´æ¥åŠ è½½å·²æœ‰ç´¢å¼•ï¼ˆç§’çº§å¯åŠ¨ï¼‰
python app.py
```

**æ–‡ä»¶ç»“æ„ï¼š**
```
your-project/
â”œâ”€â”€ food_research_data/     # åŸå§‹æ–‡æ¡£
â”‚   â”œâ”€â”€ papers/
â”‚   â””â”€â”€ datasets/
â”œâ”€â”€ storage/                # æŒä¹…åŒ–ç´¢å¼•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ docstore.json
â”‚   â”œâ”€â”€ index_store.json
â”‚   â””â”€â”€ vector_store.json
â””â”€â”€ app.py
```

---

### æ–¹å¼2: å¤–éƒ¨å‘é‡æ•°æ®åº“

#### 2.1 Chromaï¼ˆæ¨èï¼Œæœ€ç®€å•ï¼‰

**å®‰è£…ï¼š**
```bash
pip install chromadb
```

**ä¿®æ”¹ `persistent_storage.py`ï¼š**
```python
import chromadb
from llama_index.vector_stores.chroma import ChromaVectorStore

# åˆ›å»ºChromaå®¢æˆ·ç«¯
chroma_client = chromadb.PersistentClient(path="./chroma_db")
chroma_collection = chroma_client.get_or_create_collection("food_research")

# åˆ›å»ºå‘é‡å­˜å‚¨
vector_store = ChromaVectorStore(chroma_collection=chroma_collection)
storage_context = StorageContext.from_defaults(vector_store=vector_store)

# æ„å»ºç´¢å¼•
index = VectorStoreIndex.from_documents(
    documents,
    storage_context=storage_context
)
```

**ä¼˜ç‚¹ï¼š**
- å®Œå…¨å…è´¹
- æœ¬åœ°è¿è¡Œï¼Œæ•°æ®å®‰å…¨
- æ”¯æŒå¢é‡æ›´æ–°
- æ€§èƒ½ä¼˜ç§€

---

#### 2.2 Qdrantï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰

**å®‰è£…ï¼š**
```bash
pip install qdrant-client
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```python
from qdrant_client import QdrantClient
from llama_index.vector_stores.qdrant import QdrantVectorStore

# æœ¬åœ°æ¨¡å¼
client = QdrantClient(path="./qdrant_db")

# æˆ–äº‘ç«¯æ¨¡å¼
# client = QdrantClient(
#     url="https://your-cluster.qdrant.io",
#     api_key="your-api-key"
# )

vector_store = QdrantVectorStore(
    client=client,
    collection_name="food_research"
)
```

**ä¼˜ç‚¹ï¼š**
- é«˜æ€§èƒ½ï¼Œæ”¯æŒå¤§è§„æ¨¡æ•°æ®
- æ”¯æŒè¿‡æ»¤å’Œæ··åˆæœç´¢
- å¯æœ¬åœ°æˆ–äº‘ç«¯éƒ¨ç½²
- æœ‰å…è´¹äº‘æœåŠ¡é¢åº¦

---

#### 2.3 Pineconeï¼ˆäº‘ç«¯æ‰˜ç®¡ï¼‰

**å®‰è£…ï¼š**
```bash
pip install pinecone-client
```

**é…ç½®ï¼š**
```bash
# åœ¨ .env æ–‡ä»¶ä¸­æ·»åŠ 
PINECONE_API_KEY=your-api-key
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```python
from pinecone import Pinecone
from llama_index.vector_stores.pinecone import PineconeVectorStore

pc = Pinecone(api_key=os.getenv('PINECONE_API_KEY'))
pinecone_index = pc.Index("food-research")

vector_store = PineconeVectorStore(pinecone_index=pinecone_index)
```

**ä¼˜ç‚¹ï¼š**
- å®Œå…¨æ‰˜ç®¡ï¼Œæ— éœ€ç»´æŠ¤
- è‡ªåŠ¨æ‰©å±•
- é«˜å¯ç”¨æ€§
- æœ‰å…è´¹é¢åº¦

---

### æ–¹å¼3: ä¼ ç»Ÿæ•°æ®åº“ + å‘é‡æ‰©å±•

#### PostgreSQL + pgvector

**å®‰è£…ï¼š**
```bash
# å®‰è£…PostgreSQLæ‰©å±•
CREATE EXTENSION vector;

# å®‰è£…Pythonåº“
pip install psycopg2-binary pgvector
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```python
from llama_index.vector_stores.postgres import PGVectorStore

vector_store = PGVectorStore.from_params(
    database="food_research",
    host="localhost",
    password="your-password",
    port=5432,
    user="postgres",
    table_name="embeddings",
    embed_dim=512
)
```

---

## ğŸ“¤ ä¸Šä¼ æ–‡æ¡£çš„ä¸‰ç§æ–¹å¼

### æ–¹æ³•1: Webç•Œé¢ä¸Šä¼ ï¼ˆæ¨èï¼‰

1. å¯åŠ¨ç³»ç»Ÿï¼š
```bash
python app.py
```

2. è®¿é—®ä¸Šä¼ é¡µé¢ï¼š
```
http://localhost:5001/upload.html
```

3. é€‰æ‹©æ–‡ä»¶ç±»å‹ï¼ˆè®ºæ–‡/æ•°æ®é›†ï¼‰
4. é€‰æ‹©æ–‡ä»¶ï¼ˆæ”¯æŒæ‰¹é‡ï¼‰
5. ç‚¹å‡»ä¸Šä¼ 
6. **ç³»ç»Ÿä¼šè‡ªåŠ¨é‡å»ºç´¢å¼•**

---

### æ–¹æ³•2: ç›´æ¥å¤åˆ¶æ–‡ä»¶

```bash
# å¤åˆ¶åˆ°papersç›®å½•
cp your_paper.pdf food_research_data/papers/

# å¤åˆ¶åˆ°datasetsç›®å½•
cp your_data.csv food_research_data/datasets/

# é‡å¯åº”ç”¨ï¼ˆä¼šè‡ªåŠ¨é‡å»ºç´¢å¼•ï¼‰
python app.py
```

---

### æ–¹æ³•3: ä½¿ç”¨APIä¸Šä¼ 

```python
import requests

# ä¸Šä¼ æ–‡ä»¶
files = {'files': open('paper.pdf', 'rb')}
data = {'category': 'papers'}

response = requests.post(
    'http://localhost:5001/api/upload',
    files=files,
    data=data
)

print(response.json())
```

---

## ğŸ”„ ç´¢å¼•æ›´æ–°ç­–ç•¥

### å½“å‰å®ç°ï¼ˆå®Œå…¨é‡å»ºï¼‰

```python
# ä¸Šä¼ æ–°æ–‡æ¡£å
def reload_documents():
    # åˆ é™¤æ—§ç´¢å¼•
    shutil.rmtree("./storage")
    
    # é‡æ–°åŠ è½½æ‰€æœ‰æ–‡æ¡£
    documents = SimpleDirectoryReader("food_research_data").load_data()
    
    # é‡å»ºç´¢å¼•
    index = VectorStoreIndex.from_documents(documents)
    index.storage_context.persist()
```

**é€‚ç”¨åœºæ™¯ï¼š**
- æ–‡æ¡£æ•°é‡è¾ƒå°‘ï¼ˆ< 1000ä¸ªï¼‰
- ä¸é¢‘ç¹æ›´æ–°
- è¿½æ±‚ç®€å•å¯é 

---

### å¢é‡æ›´æ–°ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰

```python
# åªæ·»åŠ æ–°æ–‡æ¡£ï¼Œä¸é‡å»ºæ•´ä¸ªç´¢å¼•
def add_new_documents(new_files):
    # åŠ è½½æ–°æ–‡æ¡£
    new_docs = SimpleDirectoryReader(input_files=new_files).load_data()
    
    # æ’å…¥åˆ°å·²æœ‰ç´¢å¼•
    for doc in new_docs:
        index.insert(doc)
    
    # ä¿å­˜æ›´æ–°
    index.storage_context.persist()
```

**é€‚ç”¨åœºæ™¯ï¼š**
- æ–‡æ¡£æ•°é‡å¾ˆå¤§ï¼ˆ> 10000ä¸ªï¼‰
- é¢‘ç¹æ›´æ–°
- è¿½æ±‚æ€§èƒ½

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æ–¹æ¡ˆ | é¦–æ¬¡æ„å»º | é‡å¯åŠ è½½ | å¢é‡æ›´æ–° | å­˜å‚¨ç©ºé—´ |
|------|---------|---------|---------|---------|
| æœ¬åœ°æŒä¹…åŒ– | æ…¢ | **å¿«** | ä¸­ç­‰ | å° |
| Chroma | æ…¢ | **å¿«** | **å¿«** | ä¸­ç­‰ |
| Qdrant | ä¸­ç­‰ | **å¿«** | **å¿«** | ä¸­ç­‰ |
| Pinecone | ä¸­ç­‰ | **å¿«** | **å¿«** | äº‘ç«¯ |

---

## ğŸ’¡ æœ€ä½³å®è·µ

### å¼€å‘é˜¶æ®µ
```bash
# ä½¿ç”¨é»˜è®¤çš„æœ¬åœ°æŒä¹…åŒ–
python app.py
```

### ç”Ÿäº§ç¯å¢ƒï¼ˆå°è§„æ¨¡ï¼‰
```bash
# ä½¿ç”¨Chroma
pip install chromadb
# ä¿®æ”¹ä»£ç ä½¿ç”¨Chroma
```

### ç”Ÿäº§ç¯å¢ƒï¼ˆå¤§è§„æ¨¡ï¼‰
```bash
# ä½¿ç”¨Qdrantäº‘æœåŠ¡
pip install qdrant-client
# é…ç½®äº‘ç«¯è¿æ¥
```

### ä¼ä¸šçº§åº”ç”¨
```bash
# ä½¿ç”¨Pineconeæˆ–è‡ªå»ºQdranté›†ç¾¤
pip install pinecone-client
# é…ç½®APIå¯†é’¥
```

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1: ç´¢å¼•åŠ è½½å¤±è´¥

**è§£å†³æ–¹æ³•ï¼š**
```bash
# åˆ é™¤æ—§ç´¢å¼•ï¼Œé‡æ–°æ„å»º
rm -rf storage/
python app.py
```

### é—®é¢˜2: å†…å­˜ä¸è¶³

**è§£å†³æ–¹æ³•ï¼š**
```python
# ä½¿ç”¨å¤–éƒ¨æ•°æ®åº“ï¼ˆChroma/Qdrantï¼‰
# æˆ–å‡å°‘chunk_size
Settings.chunk_size = 256  # é»˜è®¤512
```

### é—®é¢˜3: æŸ¥è¯¢é€Ÿåº¦æ…¢

**è§£å†³æ–¹æ³•ï¼š**
```python
# å‡å°‘æ£€ç´¢æ•°é‡
query_engine = index.as_query_engine(
    similarity_top_k=3  # é»˜è®¤5
)
```

---

## ğŸ“ æ€»ç»“

1. **é»˜è®¤æ–¹æ¡ˆå·²ç»æ”¯æŒæŒä¹…åŒ–**ï¼Œä¸éœ€è¦æ¯æ¬¡é‡å»º
2. **ä¸Šä¼ æ–°æ–‡æ¡£æ—¶æ‰ä¼šé‡å»ºç´¢å¼•**
3. **å¯ä»¥é€‰æ‹©å¤–éƒ¨æ•°æ®åº“**è·å¾—æ›´å¥½æ€§èƒ½
4. **æ¨èä½¿ç”¨Chroma**ä½œä¸ºç¬¬ä¸€ä¸ªå‡çº§æ–¹æ¡ˆ

éœ€è¦å¸®åŠ©ï¼Ÿè¿è¡Œç¤ºä¾‹ï¼š
```bash
python notebooks/08_å¤–éƒ¨æ•°æ®åº“é›†æˆ.py
```
